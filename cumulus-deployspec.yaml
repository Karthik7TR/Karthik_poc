---
# Defaults section is optional.  Items in both Defaults and a specific environment are overridden by the value
#  in the environment.
Defaults:
  DeployerVersion: "1" # Required: Specifies the version of the deployer to use.
  AssetId: 206296 # Optional: The asset ID associated with the service.  Defaults to the same AssetId as the Deployment Engine'sf
  DeployerType: blue_green_deployer  # Required: Specifies the deployer to be used.
  ServiceName: TEN-Acct-Id  # FIXME  Same as your GroupName.  Outside this dojo, this would be the actual service name you are deploying.

  # Optional: If not specified, it is Autogenerated from the above parameters.
  # DeploymentRole: arn:aws:iam::307097860667:role/human-role/a205930-PowerUser2

  DeployerParameters:  # Required: Parameters specific to the blue/green deployer.
    SfnArn: "arn:aws:states:us-east-1:307097860667:stateMachine:a206296-TEN-Acct-Id-BlueGreenDeployMachine"   # Optional: Autogenerated from *deployer's* account, groupname, region, and AIID if empty
    Service:
      EnvironmentType: DEVELOPMENT # Mandatory.
      ResourceOwner: firstname.lastname@tr.com  # Mandatory FIXME Your email
      # Version: "1" # Optional: Defaults to "1".  Can be modified by the bake stage since the version is known there.
    Notifications:
      # Mandatory: The SNS Arn to publish to whenever a deploy failure is detected.
      FailureSnsArn: arn:aws:sns:us-east-1:307097860667:a206296-TEN-Acct-Id-bluegreen-resource-cleanup-topic # FIXME Can use SNSTopic from bluegreen-deployer-resource-cleaner CloudFormation stack

      # One or both of the below are required.
      # Conditional: SNS topic to publish to alert for testing of a new unreleased version.
      TestingSnsArn: arn:aws:sns:us-east-1:307097860667:a206296-TEN-Acct-Id-bluegreen-resource-cleanup-topic # FIXME Can use SNSTopic from bluegreen-deployer-resource-cleaner CloudFormation stack
      # Conditional: SQS Queue Url to post to in order to begin testing of a new unreleased version.
      # TestingSqsUrl: "https://sqs.us-east-1.amazonaws.com/307097860667/a205930-cumulus-testing-sqs-queue-Queue-1CTE0LBZIVV16"
    Cleanup:
      DenyDeployment: 3 # Optional: Days to keep deployments that were denied before release.  Defaults to 10 days.
      FailedTrafficShift: 5 # Optional: Days to keep deployments that failed during traffic shift.  Defaults to 10 days.
      OldVersion: 1 # Optional: Days to keep old versions of deployment after they are replaced.  Defaults to 10 days.
    Stack:
      Template: # Mandatory:
        # Use these to use a built-in template
        # Name: ecs
        # Version: 1

        # If your cfn template is in S3, it can be specified as below.
        # Url: "s3://a206296-tr-tax-prof1-cicd-nonprod-us-east-1-cfn/templates/fargate_service.yaml"

        # Use these to do the same thing as `Url` above.
        Bucket: a206296-tr-tax-prof1-cicd-nonprod-us-east-1-cfn
        Key: templates/fargate_service.yaml

      Parameters: # Parameters to pass to the CloudFormation stack provisioning your versioned service.
        ServiceName: TEN-Acct-Id  # FIXME  Same as your GroupName
        ContainerPort: 8080
        ContainerCpu: 256
        ContainerMemory: 512
    Routing:
      TestingEndpoint: "http://www.yourendpoint.com" # Required: Used in testing alert message to indicate what URL to test on.
      TargetGroupRouter:
        TargetRulePriority: 20000  # The priority you want your application to run at when it is live to customers.
        GreenRulePriority: 19999  # The priority the app should be deployed to initially.  Should be higher in priority (a lower number) than the TargetRulePriority
        Stack:
          Template: # Mandatory:  One of below must be specified.
            # Use these to use a built-in template
            # Name: target-group
            # Version: 1

            # If your cfn template is in S3, it can be specified as below.
            # Url: "s3://a205930-cloud-scrum/ben-dojo/target_group.yaml"

            # Use these to do the same thing as `Url` above.
            Bucket: a206296-tr-tax-prof1-cicd-nonprod-us-east-1-cfn
            Key: templates/target_group.yaml
          Parameters: # Parameters to pass to the CloudFormation stack provisioning your target group and listener rule.
            RoutePathPatterns: /
            HealthCheckPath: /
            TargetGroupPort: 8080
dev:
  AccountId: "773476038677" # Recommended: The account to deploy to.  Defaults to the account the Deployment Engine is in.
  AccountRegion: us-east-1  # Recommended: The region to deploy to.  Defaults to the region the Deployment Engine is in.
  DeployerParameters:
    Stack:
      Parameters: # Environment specific stack parameters
        ImageUrl: "Filled in by BakeSpec"
        DesiredCount: 1
        ClusterName: a206296-dojo-TEN-Acct-Id-dev
        SecurityGroup: sg-085123378cd6a9235  # FIXME From output `FargateContainerSecurityGroup` in a206296-TEN-Acct-Id-ems-dojo-dev-ecs-cluster-ecsconfig stack in deployment account
        ExecutionRoleArn: arn:aws:iam::773476038677:role/a206296-TEN-Acct-Id-ems-dojo-dev-ECSTaskExecutionRole-1PO057ZBKJ6SK  # FIXME From output `ECSTaskExecutionRoleArn` in a206296-TEN-Acct-Id-ems-dojo-dev-ecs-cluster-ecsconfig stack in deployment account
    Routing:
      TargetGroupRouter:
        ListenerARN: arn:aws:elasticloadbalancing:us-east-1:773476038677:listener/app/a206296-dojo-TEN-Acct-Id-dev/f2f03418ca93bbbc/a994bac829c721d9  # FIXME From output `HTTPAlbListener` in a206296-TEN-Acct-Id-ems-dojo-dev-alb-ecs-allconfig stack in deployment account

qa:
  AccountId: "773476038677" # Recommended: The account to deploy to.  Defaults to the account the Deployment Engine is in.
  AccountRegion: us-east-1  # Recommended: The region to deploy to.  Defaults to the region the Deployment Engine is in.
  DeployerParameters:
    Stack:
      Parameters: # Environment specific stack parameters
        ImageUrl: "Filled in by BakeSpec"
        DesiredCount: 1
        ClusterName: a206296-dojo-TEN-Acct-Id-qa
        SecurityGroup: sg-043de10eb20e6f39b  # FIXME From output `FargateContainerSecurityGroup` in a206296-TEN-Acct-Id-ems-dojo-qa-ecs-cluster-ecsconfig stack in deployment account
        ExecutionRoleArn: arn:aws:iam::773476038677:role/a206296-TEN-Acct-Id-ems-dojo-qa-ECSTaskExecutionRole-1PFYHDB55196I  # FIXME From output `ECSTaskExecutionRoleArn` in a206296-TEN-Acct-Id-ems-dojo-qa-ecs-cluster-ecsconfig stack in deployment account
    Routing:
      TargetGroupRouter:
        ListenerARN: arn:aws:elasticloadbalancing:us-east-1:773476038677:listener/app/a206296-dojo-TEN-Acct-Id-qa/95254eb4bb02a6f3/eca7c4b4bae1c0a0  # FIXME From output `HTTPAlbListener` in a206296-TEN-Acct-Id-ems-dojo-qa-alb-ecs-allconfig stack in deployment account
