<beans:beans xmlns="http://www.springframework.org/schema/batch"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
           http://www.springframework.org/schema/beans 	 http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd
           http://www.springframework.org/schema/batch   http://www.springframework.org/schema/batch/spring-batch-3.0.xsd">

	<job id="ebookGeneratorXppJob">
		<step id="initializeXppJobStep">
			<tasklet ref="initializeXppJobTask" />
			<next on="COMPLETED" to="unpackBundleStep" />
			<fail on="FAILED" />
		</step>
		<step id="unpackBundleStep">
			<tasklet ref="unpackBundleTask" />
			<next on="COMPLETED" to="originalStructureTransformationStep" />
			<fail on="FAILED" />
		</step>
		
		<step id="originalStructureTransformationStep">
			<tasklet ref="originalStructureTransformationTask" />
			<next on="COMPLETED" to="placeXppMetadataStep" />
			<fail on="FAILED" />
		</step>
        
        <step id="placeXppMetadataStep">
			<tasklet ref="placeXppMetadataTask" />
			<next on="COMPLETED" to="addSectionbreaksToOriginalStep" />
			<fail on="FAILED" />
		</step>
        
        <step id="addSectionbreaksToOriginalStep">
            <tasklet ref="addSectionbreaksToOriginalTask" />
            <next on="COMPLETED" to="splitOriginalStep" />
            <fail on="FAILED" />
        </step>
        
		<step id="splitOriginalStep">
			<tasklet ref="splitOriginalTask" />
			<next on="COMPLETED" to="unitePagesPartsStep" />
			<fail on="FAILED" />
		</step>
		<step id="unitePagesPartsStep">
			<tasklet ref="unitePagesPartsTask" />
			<next on="COMPLETED" to="transformToHtmlStep" />
			<fail on="FAILED" />
		</step>
		<step id="transformToHtmlStep">
			<tasklet ref="transformToHtmlTask" />
			<next on="COMPLETED" to="createDocToImageMappingStep" />
			<fail on="FAILED" />
		</step>
        <!--<step id="generateInternalAnchorsMapStep">
            <tasklet ref="internalAnchorsTask" />
            <next on="COMPLETED" to="createDocToImageMappingStep" />
            <fail on="FAILED" />
        </step>-->
        <step id="createDocToImageMappingStep">
            <tasklet ref="createDocToImageMappingTask" />
            <next on="COMPLETED" to="getXppDynamicImagesStep" />
            <fail on="FAILED" />
        </step>
        <step id="getXppDynamicImagesStep">
            <tasklet ref="getXppDynamicImagesTask" />
            <next on="COMPLETED" to="extractTocStep" />
            <fail on="FAILED" />
        </step>
        <step id="extractTocStep">
            <tasklet ref="extractTocTask" />
            <next on="COMPLETED" to="moveResourcesToAssembleDirectoryXppStep" />
            <fail on="FAILED" />
        </step>
		<step id="moveResourcesToAssembleDirectoryXppStep">
			<tasklet ref="moveResourcesToAssembleDirectoryXppTask" />
			<next on="COMPLETED" to="generateTitleMetadataStep" />
			<fail on="FAILED" />
		</step>
		<step id="generateTitleMetadataStep">
			<tasklet ref="generateTitleMetadataTask" />
			<next on="COMPLETED" to="assembleXppBookStep" />
			<fail on="FAILED" />
		</step>
		<step id="assembleXppBookStep">
			<tasklet ref="assembleXppBookTask" />
			<next on="COMPLETED" to="deliverXppBookStep" />
			<fail on="FAILED" />
		</step>
		<step id="deliverXppBookStep">
			<tasklet ref="deliverXppBookTask" />
			<next on="COMPLETED" to="groupXppBookStep" />
			<fail on="FAILED" />
		</step>
		<step id="groupXppBookStep">
			<tasklet ref="groupXppBookTask" />
			<next on="COMPLETED" to="archiveXppBookStep" />
			<fail on="FAILED" />
		</step>
		<step id="archiveXppBookStep">
			<tasklet ref="archiveXppBookTask" />
			<next on="COMPLETED" to="sendEmailNotificationXppStep" />
			<fail on="FAILED" />
		</step>
		<step id="sendEmailNotificationXppStep">
			<tasklet ref="sendEmailNotificationXppTask" />
			<end on="COMPLETED" />
			<fail on="FAILED" />
		</step>
	</job>

	<beans:bean id="xppStepFailureNotificationService"
		class="com.thomsonreuters.uscl.ereader.xpp.common.XppStepFailureNotificationServiceImpl" />
	<beans:bean id="initializeXppJobTask" scope="step" parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.initialize.InitializeTask" />
	<beans:bean id="unpackBundleTask" scope="step" parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.unpackbundle.step.UnpackBundleTask" />
	<beans:bean id="originalStructureTransformationTask" scope="step"
		parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.transformation.originalstructure.step.OriginalStructureTransformationStep" />
	<beans:bean id="placeXppMetadataTask" scope="step"
		parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.transformation.place.xpp.metadata.step.PlaceXppMetadataStep" />	
    <beans:bean id="addSectionbreaksToOriginalTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.transformation.sectionbreaks.step.AddSectionbreaksStep" />
	<beans:bean id="splitOriginalTask" scope="step" parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.transformation.split.step.SplitOriginalStep" />
    <beans:bean id="unitePagesPartsTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.transformation.uniteparts.step.UnitePagePartsStep" />
    <beans:bean id="transformToHtmlTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.transformation.tohtml.step.TransformationToHtmlStep" />
    <beans:bean id="internalAnchorsTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.transformation.internalAnchors.step.InternalAnchorsStep" />
    <beans:bean id="createDocToImageMappingTask" scope="step" parent="bookStep"
         class="com.thomsonreuters.uscl.ereader.xpp.gather.docToImageMapping.step.DocToImageMappingStep" />
    <beans:bean id="getXppDynamicImagesTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.gather.GatherXppDynamicImagesTask" />
    <beans:bean id="extractTocTask" scope="step" parent="bookStep"
        class="com.thomsonreuters.uscl.ereader.xpp.transformation.toc.step.ExtractTocStep" />
	<beans:bean id="moveResourcesToAssembleDirectoryXppTask" scope="step" parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.transformation.move.resources.step.MoveResourcesToAssembleDirectoryXpp" />
	<beans:bean id="generateTitleMetadataTask" scope="step" parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.transformation.generate.title.metadata.step.GenerateTitleMetadataStep" />
	<beans:bean id="assembleXppBookTask" scope="step" parent="assembleStep"
		class="com.thomsonreuters.uscl.ereader.xpp.assemble.step.AssembleXppStep" />
	<beans:bean id="deliverXppBookTask" scope="step" parent="deliverStep"
		class="com.thomsonreuters.uscl.ereader.xpp.deliver.step.DeliverXppStep" />
	<beans:bean id="groupXppBookTask" scope="step" parent="groupStep"
		class="com.thomsonreuters.uscl.ereader.xpp.group.step.GroupXppStep" />
	<beans:bean id="archiveXppBookTask" scope="step" parent="archiveStep"
		class="com.thomsonreuters.uscl.ereader.xpp.archive.step.ArchiveXppStep" />
	<beans:bean id="sendEmailNotificationXppTask" scope="step"
		parent="bookStep"
		class="com.thomsonreuters.uscl.ereader.xpp.notification.SendEmailNotification" />
</beans:beans>